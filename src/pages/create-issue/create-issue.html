<!--
  Generated template for the CreateIssuePage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>CreateIssue</ion-title>
  </ion-navbar>

</ion-header>

<ion-content block>
  <button ion-button (click)='providerTest()'>retrieve from the provider</button>

  <!-- FORMULAIRE -->
  <form #issueCreationForm='ngForm' (submit)='createIssue(issueCreationForm)'>
    <!-- Description input -->
    <ion-item>
      <ion-label floating>Description</ion-label>
      <!-- Nous avons choisi de mettre le description en required au contraire de l'API car nous jugeons cette information tout de mÃªme assez importante.-->
      <ion-input type='text' required
                 name='description' [(ngModel)]='issueRequest.description' #descriptionInput='ngModel'>
      </ion-input>
    </ion-item>

    <!-- Longitude input -->
    <ion-item>
      <ion-label floating>Longitude</ion-label>
      <ion-input type='number' required
                 name='longitude' [(ngModel)]='issueRequest.location.coordinates[0]'>
      </ion-input>
    </ion-item>
   
    <!-- Latitude input -->
    <ion-item>
      <ion-label floating>Latitude</ion-label>
      <ion-input type='number' required
                 name='latitude' [(ngModel)]='issueRequest.location.coordinates[1]'>
      </ion-input>
    </ion-item>

    <!-- Issue type HREF -->
    <ion-item *ngIf="issueTypes">
      <ion-label floating>Issue Type HREF</ion-label>
      <ion-select name="issueType" [(ngModel)]="issueRequest.issueTypeHref" #issueTypeInput='ngModel' required>
        <ion-option *ngFor="let issueType of issueTypes" value="/api/issueTypes/{{issueType.id}}">{{issueType.name}}</ion-option>
      </ion-select>
    </ion-item>

    <!-- Tags --> 
    <ion-item>
      <ion-label floating>Tags</ion-label>
      <ion-input type='text'
                 name='issueTags' [(ngModel)]='issueRequest.tags'>
      </ion-input>
    </ion-item>

    <!-- Submit button -->
    <div padding>
      <button type='submit' ion-button block outline [disabled]='issueCreationForm.invalid'>Enregistrer l'issue</button>
    </div>

  </form> <!-- Fin du formulaire d'upload issue -->
   
    <!-- Photo -->
    <button ion-button (click)='takePicture()'>
        <ion-icon name="camera"></ion-icon>
      </button>
      <!-- Affichage de la photo -->
      <img *ngIf='picture' [src]='picture.url' />

  <ion-item>
    <p *ngIf='descriptionInput.invalid && descriptionInput.dirty'>
        A description is required.
    </p>
    <p *ngIf='description'>
      {{ description }}
    </p>
  </ion-item>

</ion-content>
