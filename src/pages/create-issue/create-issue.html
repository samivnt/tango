<!--
  Generated template for the CreateIssuePage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>CreateIssue</ion-title>
  </ion-navbar>

</ion-header>

<ion-content block>

  <!-- PHOTO -->
  <div style="position: relative" class="centeredImageContainer">
    <img *ngIf='!picture' class="centeredImage" src="http://www.pixedelic.com/themes/geode/demo/wp-content/uploads/sites/4/2014/04/placeholder.png">
    <img *ngIf='picture' class="centeredImage" [src]='picture.url' />
  </div>
  <!-- Bouton pour prendre Photo -->
  <button ion-button (click)='takePicture()' full>
      <ion-icon name="camera"></ion-icon>
  </button>
  <!--
  <ion-item>
    <ion-icon name="football" item-start large></ion-icon>
    <h2>Museum of Football</h2>
    <p>11 N. Way St, Madison, WI 53703</p>
  </ion-item>
  -->

  <!-- FORMULAIRE -->
  <form #issueCreationForm='ngForm' (submit)='createIssue(issueCreationForm)'>
    <!-- Description input -->
    <ion-item>
      <ion-label floating>Description</ion-label>
      <!-- Nous avons choisi de mettre le description en required au contraire de l'API car nous jugeons cette information tout de même assez importante.-->
      <ion-input type='text' required
                 name='description' [(ngModel)]='issueRequest.description' #descriptionInput='ngModel'>
      </ion-input>
    </ion-item>

    <!-- Longitude input -->
    <ion-item>
      <ion-label floating>Longitude</ion-label>
      <ion-input type='number' required
                 name='longitude' [(ngModel)]='issueRequest.location.coordinates[0]'>
      </ion-input>
    </ion-item>
   
    <!-- Latitude input -->
    <ion-item>
      <ion-label floating>Latitude</ion-label>
      <ion-input type='number' required
                 name='latitude' [(ngModel)]='issueRequest.location.coordinates[1]'>
      </ion-input>
    </ion-item>

    <!-- Issue type HREF -->
    <ion-item *ngIf="issueTypes">
      <ion-label floating>Issue Type HREF</ion-label>
      <ion-select interface="popover" name="issueType" [(ngModel)]="issueRequest.issueTypeHref" #issueTypeInput='ngModel' required>
        <ion-option *ngFor="let issueType of issueTypes" value="/api/issueTypes/{{issueType.id}}">{{issueType.name}}</ion-option>
      </ion-select>
    </ion-item>

    <!-- Tags --> 
    <ion-item>
      <ion-tags-input 
      [(ngModel)]='issueRequest.tags' name = 'issueTags' [placeholder]="'+ tag'" 
      [canBackspaceRemove]="true" [separatorStr]="','" [maxTags]="5"
      [once]="'true'" [mode]="'ios'"
      >
      </ion-tags-input>
    </ion-item>
    <!-- faire une ngif quand la variable possède 5 tags -->

    <!-- Submit button -->
    <div padding>
      <button type='submit' ion-button block outline [disabled]='issueCreationForm.invalid'>Enregistrer l'issue</button>
    </div>

  </form> <!-- Fin du formulaire d'upload issue -->
  
  <ion-item>
    <p *ngIf='descriptionInput.invalid && descriptionInput.dirty'>
        A description is required.
    </p>
    <p *ngIf='description'>
      {{ description }}
    </p>
  </ion-item>

</ion-content>
